# Criação do cartão

## Objetivo

Quando a análise financeira for realizada com sucesso o Serviço de análise irá solicitar em segundo plano a criação de 
um cartão. Essa tarefa será realizada pelo serviço de cartões (accounts).

Você não terá controle sobre o momento da criação do cartão, então como devemos proceder nesse caso?

#### Restrições

Para consultar se o cartão foi criado com sucesso, temos uma API específica para este fim, vamos analisá-la?

`http://localhost:8888/swagger-ui/index.html?configUrl=/v3/api-docs/swagger-config#/`

#### Resultado Esperado

Deve-se gerar o cartão em segundo plano, caso o mesmo for gerado com sucesso pelo sistema legado (cartões).

## Informações de suporte

* Está em dúvida sobre o que significa a expressão "segundo plano"? [Aqui tem uma explicação do que entendemos que você deve considerar!](../informacao_procedural/synchronous-vs-asynchronous.md)

* Está pensando em como gerar o cartão em segundo plano? Olha que interessante, já existe um projeto \ módulo no Spring 
que pensou só nisso! [Aqui você encontra como fazer isso !!!](https://docs.spring.io/spring/docs/current/spring-framework-reference/integration.html#scheduling-enable-annotation-support)

    * Teve dificuldade com a documentação? Não tem problema! [Aqui você encontra como fazer isso !!!](../informacao_suporte/spring-schedule.md) **FIXME LURAM**
    
* Está pensando em como consultar as propostas com sucesso e sem cartão gerado? [Aqui você encontra como fazer isso !!!](../informacao_suporte/spring-data-query-methods.md)
    
* Está pensando em como consultar se o cartão foi gerado com sucesso? Olha que interessante, já existe um projeto \ 
módulo no Spring que pensou só nisso! [Aqui você encontra como fazer isso !!!](https://cloud.spring.io/spring-cloud-openfeign/2.2.x/reference/html/#spring-cloud-feign)

    * Teve dificuldade com a documentação? Não tem problema! [Aqui você encontra como fazer isso !!!](../informacao_suporte/spring-schedule.md) **FIXME LURAM - Feign Cláudio**

## Sugestões de busca de conteúdo

Quando falamos de tecnologias, precisamos buscar as maiores autoridades no assunto para analisar o que aquelas pessoas 
pensaram quando criaram tal tecnologia. Aqui neste funcionalidade encostamos no Spring Schedule, Feign, etc. 

Claro que usamos apenas uma parte do que está lá, mas já vá se acostumando a ler as documentações das tecnologias. 
Vamos deixar aqui alguns links para você:

* [Spring Schedule](https://docs.spring.io/spring/docs/current/spring-framework-reference/integration.html#scheduling-annotation-support)
* [Feign](https://github.com/OpenFeign/feign)
* [RestTemplate](https://docs.spring.io/spring-android/docs/current/reference/html/rest-template.html)
* [The Twelve-Factor App](https://12factor.net/pt_br/)

## Informações para criação do conteúdo

### Alberto

1. Como saber a frequência? Quem define isso? 
2. Como definir agendamentos no SpringBoot
3. Se você deixar a lógica no agendamento e o deploy for feito em várias instâncias? Como evitar a concorrência?
4. Em um sistema fundamentalmente assíncrono, devemos contar função como ponto de dificuldade?
5. Externalizar strings de configuração por conta do acesso ao endpoint
6. O fato de ter completablefuture faz o log ser engolido e eu perdi uma hora da minha vida para descobrir. Precisa ter um controle de log muito mais fino

### Luram Archanjo

Sugestão, detalhar o fluxo de geração do cartão, fiquei confuso.

Sugestão, ter uma API de GET para obter as informações, como: status, id, etc.
