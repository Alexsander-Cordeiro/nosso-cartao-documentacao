# Criar biometria

## Objetivo

O portador do cartão deseja realizar o cadastro da biometria para conseguir acesso ao aplicativo usando a mesma. 
O cartão pode ter uma ou mais biometrias associadas.

#### Necessidades

Realizar o cadastro da biometria. Devemos armazenar a data em que a biometria foi associada para futuras auditorias.

- Informar o identificador do cartão.
- Informar um fingerprint da biometria.

#### Restrições

- Identificador do cartão e obrigatório na URL (path parameter).

#### Resultado Esperado

- Retornar status 201 quando a biometria foi cadastrada com sucesso.
- Retornar status 400 quando o cartão nao existir ou biometria nao foi enviada.

## Informações de suporte

* A prioridade do código é funcionar. O jeito mais fácil de você já perceber seu código funcionando é recebendo os dados de criação da biometria que vão chegar via requisição http. Está em dúvida de como fazer isso no Spring? [Aqui tem uma dica](https://spring.io/guides/gs/rest-service/)

* Talvez esteja pensando em qual método HTTP utilizar, qual se aplica ao cenário de criação de biometria? [Aqui você encontra como fazer isso !!!](../informacao_suporte/rest-methods.md)

  * Ainda está com dúvida sobre qual método HTTP utilizar, não se preocupe, [aqui você encontra como fazer isso !!!](../informacao_suporte/rest-post.md)

* Está em dúvida de como receber os dados da requisição? [Aqui tem uma explicação do que entendemos que você deve considerar](../informacao_suporte/recebe-dados-requisicao.md)

* [Uma biometria tem algumas restrições e uma prática de código extremamente importante para aumentar a confiabilidade de execução é garantir que uma lógica só funcione com dados que estejam válidos](link aqui) **FIXME Alberto**. É necessário que você proteja as bordas do sistema. E quanto mais externa, maior a proteção. Como você para garantir que nenhum dado inválido vai ser aceito?

* Está pensando em como fazer as validações dos dados do seu objeto? Olha que interessante, já existe um especificação no mundo Java que pensou só nisso. Ela é chamada Bean Validation. Inclusive o Spring já tem integração fina com ela. [Confere essa dica aqui](../informacao_suporte/bean-validation.md)

	* Talvez para validar a biometria precisaremos utilizar as anotações: [@NotNull](https://javaee.github.io/javaee-spec/javadocs/javax/validation/constraints/NotNull.html), [@NotBlank](https://javaee.github.io/javaee-spec/javadocs/javax/validation/constraints/NotBlank.html). 

* No material anterior você viu que o Spring suporta dois modos diferentes de ser informado que determinado parâmetro precisa ser validado. Ficou curioso(a) sobre as diferenças? [Dá uma olhada aqui](../informacao_suporte/bean-validation-valid-vs-validated.md)

* Dado que a borda mais externa do seu sistema está protegida e também considerando que você leu as considerações que fizemos sobre receber os dados, você agora pode estar pensando em como fazer gravar tais dados. Lembre que estamos criando uma biometria, então neste ponto esta classe deve aparecer(ou já apareceu) no seu sistema. Como você vai transformar o objeto que tem os dados de uma nova biometria para um objeto que representa a proposta em si? [Aqui temos um texto que te mostra algumas formas](link aqui) **FIXME Alberto**

* Está em dúvida de como salvar a biometria na base de dados, para isto o Spring tem o projeto Spring Data JPA, quer saber mais? [Aqui você encontra como fazer isso !!!](../informacao_suporte/spring-data.md)

* Está em dúvida de como configurar o Spring Data JPA? [Aqui você encontra como fazer isso !!!](../informacao_suporte/spring-data-configuration.md)

* Está em dúvida de como mapear a entidade biometria, utilizando Spring Data JPA? [Aqui você encontra como fazer isso !!!](../informacao_suporte/spring-data-entity.md)

* Está em dúvida de como declarar o repositório da biometria, utilizando Spring Data JPA? [Aqui você encontra como fazer isso !!!](../informacao_suporte/spring-data-repository.md)

* Está em dúvida sobre o por que **201** no retorno dessa chamada? [Aqui você encontra como fazer isso !!!](../informacao_suporte/rest-201.md)

* Está em dúvida sobre o por que **400** no retorno dessa chamada? [Aqui você encontra como fazer isso !!!](../informacao_suporte/rest-400.md)

* Talvez seu código não está funcionando e está com dificuldade de encontrar o problema? Aprenda mais sobre logs! [Aqui você encontra como fazer isso !!!](../informacao_suporte/spring-logging.md)

## Sugestões de busca de conteúdo

Quando falamos de tecnologias, precisamos buscar as maiores autoridades no assunto para analisar o que aquelas pessoas 
pensaram quando criaram tal tecnologia. Aqui neste funcionalidade encostamos na Bean Validation, Spring Validation, Spring MVC, etc. 

Claro que usamos apenas uma parte do que está lá, mas já vá se acostumando a ler as documentações das tecnologias. 
Vamos deixar aqui alguns links para você:

* [Bean Validation](https://beanvalidation.org/)
* [Spring MVC](https://docs.spring.io/spring/docs/current/spring-framework-reference/web.html)
* [Spring Validation](https://docs.spring.io/spring/docs/current/spring-framework-reference/core.html#validation)
* [Spring Data JPA](https://spring.io/projects/spring-data-jpa)
* [OWASP Mass assignment](https://en.wikipedia.org/wiki/Mass_assignment_vulnerability)

## Informações para criação do conteúdo

### Claudio

I.S => não ficou claro a criacao do cartão, depois da proposta encontrar o cartão o mesmo deve ser persistido.

I.S => assinatura deve ser recebida encodada em base64

I.P => Vale a pena entrar em méritos de segurança, como por exemplo cuidados necessários para armazenar número de cartão de crédito

I.P => Preocupação com XSS e ataques conhecidos???

### Alberto

* Onde vai ficar sua lógica de associação entre a biometria e o cartão?
* E se não tiver aquele cartão, como você vai fazer para retornar o status?

### Luram Archanjo

Sugestão, qual contexto da biometria?

Sugestão, no caso do cartão não encontrado não deveria ser 404?

Sugestão, no caso de criação de biometria não deveria voltar o Location?
