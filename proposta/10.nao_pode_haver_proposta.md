# Não pode haver mais de uma proposta para o mesmo solicitante

## Objetivo

Criamos o fluxo de geração de proposta, porém nosso cliente solicitou uma alteração, na qual é adicionar uma nova 
validação na qual não podemos permitir que tenha duas propostas para o mesmo solicitante, ou seja, para o mesmo 
CNPJ ou CPF.

#### Resultado Esperado

Não podemos permitir que tenha duas propostas para o mesmo solicitante, ou seja, para o mesmo 
CNPJ ou CPF.

- Devemos retornar o status code **422**, quando o solicitante ja requisitou uma proposta.
- Permitir a criação de uma proposta, caso o solicitante não tenha nenhuma outra.

## Informações de suporte

Está em dúvida como fazer uma consulta de proposta no banco de dados utilizando Spring Data JPA?  [Aqui você encontra como fazer isso !!!](../informacao_suporte/spring-data-query-methods.md)

Está em dúvida como retornar um HTTP status code no Spring? [Dá uma olhada aqui!](../informacao_suporte/spring-response-entity.md)

Está em dúvida sobre a motivação de retornar **422** quando o solicitante ja requisitou uma proposta? [Dá uma olhada aqui!](../informacao_suporte/rest-422.md)

Talvez esteja se perguntando, temos dois cenários de erro o 400 e o 422, porém não temos a visibilidade do erro em questão! 

* Gostaria de saber a padronização de erros utilizada pela Zup? [Aqui você encontra como fazer isso !!!](../informacao_suporte/error-zup.md)
* Gostaria de saber a padronização de erros utilizada pelo Spring Boot? [Aqui você encontra como fazer isso !!!](../informacao_suporte/error-spring.md)
* Gostaria de saber a padronização de erros seguindo as boas práticas de Orientação a Objetos? [Aqui você encontra como fazer isso !!!](../informacao_suporte/error-zup.md) **FIXME Luram**

## Sugestões de busca de conteúdo

Quando falamos de tecnologias, precisamos buscar as maiores autoridades no assunto para analisar o que aquelas pessoas 
pensaram quando criaram tal tecnologia. Aqui neste funcionalidade encostamos na Bean Validation Spring Data JPA, etc. 

Claro que usamos apenas uma parte do que está lá, mas já va se acostumando a ler as documentações das tecnologias. 
Vamos deixar aqui alguns links para você:

* [Bean Validation](https://beanvalidation.org/)
* [Spring Data JPA](https://spring.io/projects/spring-data-jpa)
* [Spring Handling Exception](https://spring.io/blog/2013/11/01/exception-handling-in-spring-mvc)